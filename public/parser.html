<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>PiGraph - Dev page</title>

    <!-- Alpine -->
    <script src="//unpkg.com/alpinejs" defer></script>

    <!-- SVG -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/svg.js/3.0.13/svg.min.js"></script>

    <!-- KaTex -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css" integrity="sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC" crossorigin="anonymous">

    <!-- The loading of KaTeX is deferred to speed up page rendering -->
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js" integrity="sha384-X/XCfMm41VSsqRNQgDerQczD69XqmjOOOwYQvr/uuC+j4OPoNhVgjdGFwhvN02Ja" crossorigin="anonymous"></script>

    <script src="https://cdn.tailwindcss.com"></script>

    <!-- PiDraw -->
    <script src="../dev/pidraw.js"></script>

</head>
<body class="min-h-screen">
<div x-data="autoParse()">
    <h1 class="text-center text-2xl font-semibold my-10">Graph builder</h1>
    <div id="root" class=" max-w-xl mx-auto" @mouseup="updateTex"></div>


    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 my-5 max-w-3xl mx-auto">
        <div class="flex flex-col">
            <div class="font-thin">Paramètres (xMin,xMax,yMin,yMax)</div>
            <input x-model="parameters" @input="modify" class=" px-2 py-3 mb-5 border rounded">

            <textarea
                x-model="construct"
                rows="10"
                class="border mx-3 md:mx-0 py-2 px-3 rounded"
                @input="build"
        ></textarea></div>
        <div class="px-3 md:px-0">
            <table class="w-full">
                <tr>
                    <td class="font-mono">A(4,6)</td>
                    <td class="font-thin">point</td>
                </tr>
                <tr>
                    <td class="font-mono">M=mid AB</td>
                    <td class="font-thin">milieu de A et B</td>
                </tr>
                <tr>
                    <td class="font-mono">d=AB</td>
                    <td class="font-thin">droite passant par A et B</td>
                </tr>
                <tr>
                    <td class="font-mono">d=line A,3/4</td>
                    <td class="font-thin">droite passant par A et de pente 3/4</td>
                </tr>
                <tr>
                    <td class="font-mono">d=line 3x-4y+5=0</td>
                    <td class="font-thin">droite d'équation</td>
                </tr>
                <tr>
                    <td class="font-mono">a=[AB]</td>
                    <td class="font-thin">segment AB</td>
                </tr>
                <tr>
                    <td class="font-mono">a=[AB[</td>
                    <td class="font-thin">demi droite AB, ouverte en B</td>
                </tr>
                <tr>
                    <td class="font-mono">a=vAB</td>
                    <td class="font-thin">vecteur AB</td>
                </tr>
                <tr>
                    <td class="font-mono">p=perp d,A</td>
                    <td class="font-thin">perpendiculaire à d par A</td>
                </tr>
                <tr>
                    <td class="font-mono">p=para d,A</td>
                    <td class="font-thin">parallèle à d par A</td>
                </tr>
                <tr>
                    <td class="font-mono">p=circ A,2</td>
                    <td class="font-thin">cercle de centre A et de rayon 2</td>
                </tr>
                <tr>
                    <td class="font-mono">f(x)=3*x-5</td>
                    <td class="font-thin">Tracer une fonction y=f(x)</td>
                </tr>
                <tr>
                    <td class="font-mono">f(t)=sin(t),cos(t),a,b</td>
                    <td class="font-thin">Tracer une fonction paramétrique, en utilisant a et b comme borne.</td>
                </tr>
                <tr>
                    <td class="font-mono">zone=fill f,g? a,b</td>
                    <td class="font-thin">Remplir l'espace entre deux fonctions, borné par a et b</td>
                </tr>
            </table>
        </div>
    </div>

    <div class="max-w-3xl mx-auto">
        <template x-for="tex of figures">
            <div x-html="tex"></div>
        </template>
    </div>

    <div class="text-center font-xs text-gray-300 mt-20 mb-5">Made with love (and some coffee) by B. Gass</div>
</div>
<script>
   function autoParse () {
		let graph = new PiDraw('root'),
            axis = graph.axis(),
            construct = `A(4,6)->drag
B(10,8)->drag
C(8,1)->drag
v=vAC
bc=[BC]
M=mid AB
d=AB->red,dash
d1=line A,2->blue,dot
d2=line 3x+4y-9=0
p1=perp d,B
p2=para d,C
c=circ B,2
f(x)=sin(x)`,
       construct2 = `A(8,3)
d=line 3x-2y+5=0`

        let parser = graph.parse(construct),
            parameters = 'grid,axis,x=-3:15,y=-4:17'

       parser.updateLayout(parameters)

		return {
            figures: graph.figures.map(x=>katex.renderToString(x.tex)),
            updateTex() {
              this.figures = graph.figures.map(x => katex.renderToString(x.tex))
            },
			construct,
            parameters,
			build () {
				parser.update(this.construct)
                this.figures= graph.figures.map(x => katex.renderToString(x.tex))
            },
            modify() {
                // Get the parameters.
                parser.updateLayout(this.parameters)
            }
		}
	}
</script>
</body>
</html>